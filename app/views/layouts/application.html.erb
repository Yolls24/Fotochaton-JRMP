<!DOCTYPE html>
<html>
  <head>
    <title>FotoChatons</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  </head>

  <body class="d-flex flex-column min-vh-100">
    <nav class="navbar navbar-expand-lg navbar-dark shadow-sm bg-dark">
      <div class="container">

        <%= link_to "🐱 FotoChatons", root_path, class: "navbar-brand fw-bold text-mauve" %>

        <div class="d-flex align-items-center gap-3">
          <% if user_signed_in? %>
            <!-- Avatar si présent -->
            <% if current_user.avatar.attached? %>
              <%= image_tag current_user.avatar.variant(resize_to_fill: [40,40]),
                  class: "rounded-circle border border-light",
                  alt: "Avatar" %>
            <% end %>

            <!-- Lien vers le profil Devise -->
            <%= link_to "Mon profil", edit_user_registration_path, class: "btn btn-outline-light" %>

            <!-- Liens Admin, Panier et Déconnexion -->
            <% if current_user.admin? %>
              <%= link_to "Admin", admin_dashboard_path, class: "btn btn-warning" %>
            <% end %>

            <%= link_to "Panier", cart_path, class: "btn btn-mauve" %>

            <%= button_to "Déconnexion",
                  destroy_user_session_path,
                  method: :delete,
                  class: "btn btn-rose",
                  form: { class: "d-inline" } %>

          <% else %>
            <%= link_to "Connexion", new_user_session_path, class: "btn btn-rose" %>
          <% end %>
        </div>

      </div>
    </nav>

    <main class="flex-grow-1">
      <%= yield %>
    </main>

    <footer class="text-center py-4 bg-secondary mt-auto">
      <p class="mb-0">© 2025 FotoChatons - Tous droits réservés.</p>
    </footer>

    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
