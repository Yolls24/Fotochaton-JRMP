<div class="container my-5">
  <h2 class="fw-bold text-mauve mb-4 text-center">Votre panier 🛒</h2>

  <% if @items.any? %>
    <div class="row g-4">
      <% total = 0 %>
      <% @items.each do |item| %>
        <% quantity = session[:cart][item.id.to_s] %>
        <% total += item.price * quantity %>

        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm">
            <%= image_tag item.image, alt: item.name, class: "card-img-top cart-item-image" %>
            <div class="card-body text-center">
              <h5 class="card-title"><%= item.name %></h5>
              <p class="card-text"><%= item.description %></p>
              <p class="fw-bold">Prix : <%= number_to_currency(item.price, unit: "€") %></p>
              <p class="fw-bold">Quantité : <%= quantity %></p>
              <p class="fw-bold">Total : <%= number_to_currency(item.price * quantity, unit: "€") %></p>
              <%= button_to "Supprimer", cart_remove_path(item_id: item.id), method: :delete, class: "btn btn-danger mt-2" %>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <div class="mt-5 text-center">
      <h4 class="fw-bold">Total panier : <%= number_to_currency(total, unit: "€") %></h4>
      <%= button_to "Payer avec Stripe", checkout_create_path, method: :post, class: "btn btn-mauve mt-3" %>
      <br>
      <%= link_to "← Continuer vos achats", root_path, class: "btn btn-secondary mt-2" %>
    </div>
  <% else %>
    <p class="text-center">Votre panier est vide 😿</p>
    <div class="text-center mt-3">
      <%= link_to "Parcourir les produits", root_path, class: "btn btn-primary" %>
    </div>
  <% end %>
</div>
